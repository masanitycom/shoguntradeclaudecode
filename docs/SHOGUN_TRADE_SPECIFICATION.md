# SHOGUN TRADE システム仕様書（完全版）

**最終更新: 2025-06-25**

## 1. システム概要

SHOGUN TRADEは、NFT投資とMLM（Multi-Level Marketing）を組み合わせたWeb3プラットフォームです。ユーザーはNFTを購入し、平日の日利報酬と週次の天下統一ボーナスを獲得できます。

### 主要機能

- NFT購入・管理システム
- 日利報酬計算（平日のみ）
- MLM階層システム（8段階）
- 天下統一ボーナス分配
- エアドロップタスク（報酬申請）
- 複利運用システム


## 2. NFTシステム

### 2-1. NFT保有ルール

- **1人1枚制限**: ユーザーは同時に1枚のNFTのみ保有可能
- **既存ユーザー**: 全員NFT保有済み
- **新規ユーザー**: NFT購入必須
- **300%到達時**: NFT消滅 → 再購入必要


### 2-2. 通常NFT（is_special: false）

ユーザーダッシュボードで購入可能なNFT

| NFT名 | 価格(USDT) | 日利上限
|-----|-----|-----
| SHOGUN NFT 300 | 300 | 0.5%
| SHOGUN NFT 500 | 500 | 0.5%
| SHOGUN NFT 1,000 | 1,000 | 1.0%
| SHOGUN NFT 3,000 | 3,000 | 1.0%
| SHOGUN NFT 5,000 | 5,000 | 1.0%
| SHOGUN NFT 10,000 | 10,000 | 1.25%
| SHOGUN NFT 30,000 | 30,000 | 1.5%
| SHOGUN NFT 100,000 | 100,000 | 2.0%


### 2-3. 特別NFT（is_special: true）

管理画面でのみ付与可能な特別NFT

| NFT名 | 価格(USDT) | 日利上限 | 備考
|-----|-----|-----
| SHOGUN NFT 100 | 100 | 0.5% | 特別付与のみ
| SHOGUN NFT 200 | 200 | 0.5% | 特別付与のみ
| SHOGUN NFT 600 | 600 | 0.5% | 特別付与のみ
| SHOGUN NFT 1,100 | 1,100 | 1.0% | 特別付与のみ
| SHOGUN NFT 1,177 | 1,177 | 1.0% | 特別付与のみ
| SHOGUN NFT 1,217 | 1,217 | 1.0% | 特別付与のみ
| SHOGUN NFT 1,227 | 1,227 | 1.0% | 特別付与のみ
| SHOGUN NFT 1,300 | 1,300 | 1.0% | 特別付与のみ
| SHOGUN NFT 1,350 | 1,350 | 1.0% | 特別付与のみ
| SHOGUN NFT 1,500 | 1,500 | 1.0% | 特別付与のみ
| SHOGUN NFT 1,600 | 1,600 | 1.0% | 特別付与のみ
| SHOGUN NFT 1,836 | 1,836 | 1.0% | 特別付与のみ
| SHOGUN NFT 2,000 | 2,000 | 1.0% | 特別付与のみ
| SHOGUN NFT 2,100 | 2,100 | 1.0% | 特別付与のみ
| SHOGUN NFT 3,175 | 3,175 | 1.0% | 特別付与のみ
| SHOGUN NFT 4,000 | 4,000 | 1.0% | 特別付与のみ
| SHOGUN NFT 6,600 | 6,600 | 1.0% | 特別付与のみ
| SHOGUN NFT 8,000 | 8,000 | 1.0% | 特別付与のみ


### 2-4. 特別NFTの仕様

- **表示制限**: ユーザーダッシュボードでは表示・購入不可
- **管理制限**: 管理画面でのみ登録・編集可能
- **計算ロジック**: 通常NFTと同様の日利計算を適用
- **収益上限**: 投資額の300%まで報酬獲得可能
- **機能停止**: 300%達成後は機能停止


### 2-5. NFT購入フロー（通常NFTのみ）

1. **ユーザー操作**:

1. NFT購入申請ボタンクリック
2. 購入希望金額選択（通常NFTから選択）
3. 購入申請送信



2. **システム表示**:

1. 送金先アドレス（USDT BEP20）表示
2. QRコード表示



3. **ユーザー送金**:

1. 指定アドレスにUSDT送金
2. トランザクションID入力・送信



4. **管理者承認**:

1. 送金確認
2. 承認処理
3. ユーザーダッシュボードにNFT表示





## 3. 報酬システム

### 3-1. 収益上限（重要）

- **300%キャップ**: 日利報酬 + 天下統一ボーナス = 合計300%
- **即座消滅**: 300%到達時点でNFT即座に消滅
- **全NFT共通**: 通常NFT・特別NFT問わず適用
- **プログレスバー**: 現在の収益率を視覚的に表示

```plaintext
[████████░░] 80% (240/300 USDT)
あと60 USDT でNFT消滅
```




### 3-2. 日利報酬システム

- **計算対象**: 平日のみ（月〜金）
- **週利入力**: 管理者が手動で週利を入力（例：2.6%）
- **自動振り分け**: システムが月〜金に自動配分

- 例: 週利2.6% → 月0.5%, 火0.6%, 水0.5%, 木0.5%, 金0.5%
- 0%の日があってもOK



- **計算タイミング**: 土日に前週分を計算
- **上限適用**: 各NFTの日利上限を超えない範囲で計算


### 3-3. 天下統一ボーナス

- **頻度**: 毎週
- **原資**: 会社週間利益の20%
- **分配対象**: MLMランク保有者
- **分配率**: ランク別の分配率に応じて配布
- **300%カウント**: 日利と合算して300%上限に含む


## 4. エアドロップタスク（報酬申請）

### 4-1. 申請条件

- **最低金額**: 50ドル以上の報酬が必要
- **申請期間**: 平日のみ（土日は申請不可）


### 4-2. タスク内容

- **4択問題**: 簡単な選択問題
- **例題**:

```plaintext
あなたの好きな戦国武将は？
1. 豊臣秀吉
2. 徳川家康  
3. 織田信長
4. その他
```




### 4-3. 問題管理

- **管理画面**: 管理者が問題を無限に登録可能
- **出題方式**: 登録された問題からランダム出題
- **問題形式**: 3択 + その他（固定）


## 5. MLMランクシステム

### 5-1. ランク階層

| 順位 | ランク名 | 必要NFT | 組織条件(最大/他系列) | 分配率
|-----|-----|-----
| 0 | なし | - | - | 0%
| 1 | 足軽 | NFT1000 + 組織≥1,000 | - | 45%
| 2 | 武将 | NFT1000 | 3,000/1,500 | 25%
| 3 | 代官 | NFT1000 | 5,000/2,500 | 10%
| 4 | 奉行 | NFT1000 | 10,000/5,000 | 6%
| 5 | 老中 | NFT1000 | 50,000/25,000 | 5%
| 6 | 大老 | NFT1000 | 100,000/50,000 | 4%
| 7 | 大名 | NFT1000 | 300,000/150,000 | 3%
| 8 | 将軍 | NFT1000 | 600,000/500,000 | 2%


### 5-2. ランク更新

- **頻度**: 週次バッチで自動更新
- **昇格/降格**: 条件に応じて自動処理
- **NFT条件**: 通常・特別NFT問わず価格で判定


## 6. 複利運用システム

### 6-1. 複利条件

- **未申請報酬**: エアドロップタスクを完了しなかった報酬
- **自動複利**: 未申請分は自動的に投資額に加算
- **計算タイミング**: 毎週月曜日


### 6-2. 手数料

- **EVO カード**: 5.5%
- **その他**: 8%


## 7. 週次サイクル

### 7-1. 週間スケジュール

| 曜日 | 処理内容
|-----|-----|-----
| 月曜 | 前週分報酬申請開始、複利処理
| 火〜金 | 日利計算、報酬申請受付
| 土日 | 報酬計算処理、MLMランク更新


### 7-2. 管理者作業

- **週利入力**: 金曜日に次週の週利を入力
- **利益入力**: 週間会社利益を手動入力
- **承認作業**: NFT購入申請の承認
- **特別NFT付与**: 管理画面から特別NFTを直接付与


## 8. 管理機能

### 8-1. NFT管理

- **通常NFT**: 価格・日利上限の編集
- **特別NFT**: 新規作成・編集・ユーザーへの直接付与
- **NFT状態**: アクティブ/非アクティブの切り替え


### 8-2. ユーザー管理

- **ユーザー情報**: 基本情報の編集
- **NFT付与**: 特別NFTの直接付与
- **報酬履歴**: 日利・天下統一ボーナスの確認


### 8-3. タスク管理

- **問題登録**: エアドロップタスクの問題作成
- **問題編集**: 既存問題の修正・削除
- **出題状況**: 問題の出題頻度確認


## 9. 技術アーキテクチャ

### 9-1. システム構成

```plaintext
┌─────────────────────────────┐
│  V0生成フロント (React/TW)  │  ← UI全体
└─────────────────────────────┘
                │
┌─────────────────────────────┐
│ Next.js App Router (Vercel) │  ← API・認証
│  ├─ /api/auth               │
│  ├─ /api/nft                │
│  └─ /api/reward             │
└─────────────────────────────┘
                │
┌─────────────────────────────┐
│ Supabase (PostgreSQL + RLS)│  ← データベース
└─────────────────────────────┘
                │
┌─────────────────────────────┐
│ GitHub Actions/Vercel Cron  │  ← バッチ処理
└─────────────────────────────┘
```

### 9-2. 主要テーブル

- `users`: ユーザー情報
- `nfts`: NFT情報（通常・特別NFT両方）
- `user_nfts`: ユーザーNFT保有情報
- `nft_purchase_applications`: NFT購入申請（通常NFTのみ）
- `daily_rewards`: 日利報酬
- `reward_applications`: 報酬申請
- `tasks`: エアドロップタスク
- `mlm_ranks`: MLMランク定義
- `weekly_profits`: 週間利益


## 10. 開発フェーズ

### Phase 1: 基盤システム（2-3週間）

- NFT購入申請フロー（通常NFTのみ）
- 特別NFT管理機能
- 基本的な日利計算
- エアドロップタスク
- 管理者承認システム


### Phase 2: 報酬計算（3-4週間）

- 300%キャップ込み日利計算（全NFT対応）
- 天下統一ボーナス分配
- 複利運用システム
- プログレスバー表示


### Phase 3: 自動化（2週間）

- バッチ処理実装
- MLM階層計算
- 週次サイクル管理


## 11. 重要な注意事項

### 11-1. NFT種別の取り扱い

- **購入制限**: 通常NFTのみユーザーが購入可能
- **表示制限**: 特別NFTはユーザーダッシュボードに表示しない
- **計算統一**: 日利・300%キャップは全NFT共通ロジック
- **管理権限**: 特別NFTは管理者のみ操作可能


### 11-2. 計算の複雑性

- **300%キャップ**: 日利+MLMボーナスの合計監視（全NFT共通）
- **リアルタイム処理**: NFT消滅の即座反映
- **時差管理**: 日本時間での平日判定


### 11-3. セキュリティ

- **認証**: Supabase Auth + RLS
- **権限管理**: 管理者/一般ユーザー分離
- **監査ログ**: 全取引の記録


### 11-4. 法規制対応

- 特定商取引法
- 改正資金決済法
- MLM関連法規
